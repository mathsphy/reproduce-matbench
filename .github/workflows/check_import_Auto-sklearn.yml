name: Test Auto-sklearn Import

on: [push, pull_request]

jobs:
  generate-matrix:
    runs-on: ubuntu-latest
    outputs:
      python_versions: ${{ steps.set-versions.outputs.python_versions }}
    steps:
      - name: Define Python version list
        id: set-versions
        run: |
          echo "python_versions=['3.6','3.7','3.8','3.9','3.10','3.11','3.12']" >> $GITHUB_OUTPUT

  simple-setup:
    needs: generate-matrix
    strategy:
      matrix:
        python_version: ${{ fromJson(needs.generate-matrix.outputs.python_versions) }}
    uses: ./.github/workflows/check_import.yml
    with:
      model: "Auto-sklearn"
      python_version: ${{ matrix.python_version }}
      system_dependencies: git
      conda_env_file: benchmarks/matbench_v0.1_Auto-sklearn/environment.yml
      custom_pip_lines: ""  # or omit if not used

  solution-setup:
    needs: generate-matrix
    strategy:
      matrix:
        python_version: ${{ fromJson(needs.generate-matrix.outputs.python_versions) }}
    uses: ./.github/workflows/check_import.yml
    with:
      model: "Auto-sklearn"
      python_version: ${{ matrix.python_version }}
      system_dependencies: git
      custom_pip_lines: " pip install matbench swig==4.1.0 auto-sklearn==0.15.0 'numpy<2' "
